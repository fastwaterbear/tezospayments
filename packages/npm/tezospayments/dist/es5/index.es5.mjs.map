{"version":3,"file":"index.es5.mjs","sources":["../../src/constants.ts","../../src/errors.ts","../../src/paymentUrlFactories/paymentUrlFactory.ts","../../src/paymentUrlFactories/base64PaymentUrlFactory.ts","../../src/signers/tezosPaymentsSigner.ts","../../src/models.ts","../../src/signers/apiSecretKeySigner.ts","../../src/signers/walletSigner.ts","../../src/signers/customSigner.ts","../../src/validationErrors.ts","../../src/tezosPayments.ts","../../src/index.ts"],"sourcesContent":["export default {\n  defaultNetworkName: 'mainnet',\n  paymentAppBaseUrl: 'https://payment.tezospayments.com'\n} as const;\n","import { guards } from '@tezospayments/common';\n\nconst getErrorMessageByValidationErrors = (validationErrors: readonly string[], brief = '') => validationErrors\n  .reduce((result, error, index) => `${result}\\n\\t${index + 1}. ${error};`, brief);\n\nexport abstract class TezosPaymentsError extends Error {\n  readonly name: string;\n\n  constructor(message?: string) {\n    super(message);\n\n    this.name = this.constructor.name;\n  }\n}\n\nexport class InvalidTezosPaymentsOptionsError extends TezosPaymentsError {\n  constructor(message?: string);\n  constructor(validationErrors: readonly string[]);\n  constructor(messageOrValidationErrors: (string | undefined) | readonly string[]) {\n    super(\n      guards.isReadonlyArray(messageOrValidationErrors)\n        ? InvalidTezosPaymentsOptionsError.getMessage(messageOrValidationErrors)\n        : messageOrValidationErrors\n    );\n  }\n\n  private static getMessage(validationErrors: readonly string[]): string {\n    return getErrorMessageByValidationErrors(validationErrors, 'options are invalid, see details below:');\n  }\n}\n\nexport class InvalidPaymentCreateParametersError extends TezosPaymentsError {\n}\n\nexport class InvalidPaymentError extends TezosPaymentsError {\n  constructor(message?: string);\n  constructor(validationErrors: readonly string[]);\n  constructor(messageOrValidationErrors: (string | undefined) | readonly string[]) {\n    super(\n      guards.isReadonlyArray(messageOrValidationErrors)\n        ? InvalidPaymentError.getMessage(messageOrValidationErrors)\n        : messageOrValidationErrors\n    );\n  }\n\n  private static getMessage(validationErrors: readonly string[]): string {\n    return getErrorMessageByValidationErrors(validationErrors, 'payment is invalid, see details below:');\n  }\n}\n\nexport class UnsupportedPaymentUrlTypeError extends TezosPaymentsError {\n}\n\nexport class PaymentUrlError extends TezosPaymentsError {\n}\n\nexport class DonationUrlError extends TezosPaymentsError {\n}\n","import { CustomNetwork, Donation, Network, Payment, PaymentUrlType } from '@tezospayments/common';\n\nexport abstract class PaymentUrlFactory {\n  constructor(readonly urlType: PaymentUrlType) {\n  }\n\n  abstract createPaymentUrl(paymentOrDonation: Payment | Donation, network: Network | CustomNetwork): string | Promise<string>;\n}\n","import {\n  native, PaymentUrlType,\n  PaymentSerializer, CustomNetwork, Network, Payment, Donation, DonationSerializer, PaymentType, getEncodedPaymentUrlType\n} from '@tezospayments/common';\n\nimport constants from '../constants';\nimport { DonationUrlError, PaymentUrlError } from '../errors';\nimport { PaymentUrlFactory } from './paymentUrlFactory';\n\nexport class Base64PaymentUrlFactory extends PaymentUrlFactory {\n  static readonly baseUrl = constants.paymentAppBaseUrl;\n\n  protected readonly paymentSerializer: PaymentSerializer = new PaymentSerializer();\n  protected readonly donationSerializer: DonationSerializer = new DonationSerializer();\n\n  constructor(readonly baseUrl: string = Base64PaymentUrlFactory.baseUrl) {\n    super(PaymentUrlType.Base64);\n  }\n\n  createPaymentUrl(paymentOrDonation: Payment | Donation, network: Network | CustomNetwork): string {\n    return paymentOrDonation.type === PaymentType.Payment\n      ? this.createPaymentUrlInternal(paymentOrDonation, network)\n      : this.createDonationUrlInternal(paymentOrDonation, network);\n  }\n\n  protected createPaymentUrlInternal(payment: Payment, network: Network | CustomNetwork): string {\n    const serializedPaymentBase64 = this.paymentSerializer.serialize(payment);\n    if (!serializedPaymentBase64)\n      throw new PaymentUrlError('It\\'s impossible to serialize the payment');\n\n    try {\n      return this.createUrl(true, payment.targetAddress, serializedPaymentBase64, network);\n    } catch (error: unknown) {\n      throw new PaymentUrlError('It\\'s impossible to create an URL for the payment');\n    }\n  }\n\n  protected createDonationUrlInternal(donation: Donation, network: Network | CustomNetwork): string {\n    const serializedDonationBase64 = this.donationSerializer.serialize(donation);\n    if (!serializedDonationBase64 && serializedDonationBase64 !== '')\n      throw new DonationUrlError('It\\'s impossible to serialize the donation');\n\n    try {\n      return this.createUrl(false, donation.targetAddress, serializedDonationBase64, network);\n    } catch (error: unknown) {\n      throw new DonationUrlError('It\\'s impossible to create an URL for the donation');\n    }\n  }\n\n  protected createUrl(\n    isPayment: boolean,\n    targetAddress: string,\n    serializedPaymentOrDonationBase64: string,\n    network: Network | CustomNetwork\n  ) {\n    const url = new native.URL(`${targetAddress}/${isPayment ? 'payment' : 'donation'}`, this.baseUrl);\n\n    if (serializedPaymentOrDonationBase64 !== '')\n      url.hash = getEncodedPaymentUrlType(this.urlType) + serializedPaymentOrDonationBase64;\n    if (network.name !== constants.defaultNetworkName)\n      url.searchParams.append('network', network.name);\n\n    return url.href;\n  }\n}\n","import { UnsignedPayment, PaymentSignature } from '@tezospayments/common';\n\nimport type { SigningType } from '../models';\n\nexport abstract class TezosPaymentsSigner {\n  constructor(readonly signingType: SigningType) {\n  }\n\n  abstract sign(payment: UnsignedPayment): PaymentSignature | Promise<PaymentSignature>;\n}\n","export type Payment = import('@tezospayments/common').Payment & {\n  readonly url: string;\n};\n\nexport enum SigningType {\n  ApiSecretKey = 0,\n  Wallet = 1,\n  Custom = 2,\n}\n","import { InMemorySigner } from '@taquito/signer';\n\nimport { PaymentSignPayloadEncoder, PaymentSignature, UnsignedPayment } from '@tezospayments/common';\n\nimport { SigningType } from '../models';\nimport { TezosPaymentsSigner } from './tezosPaymentsSigner';\n\nexport class ApiSecretKeySigner extends TezosPaymentsSigner {\n  protected readonly paymentSignPayloadEncoder: PaymentSignPayloadEncoder = new PaymentSignPayloadEncoder();\n  protected readonly inMemorySigner: InMemorySigner;\n\n  constructor(readonly apiSecretKey: string) {\n    super(SigningType.ApiSecretKey);\n\n    this.inMemorySigner = new InMemorySigner(this.apiSecretKey);\n  }\n\n  async sign(payment: UnsignedPayment): Promise<PaymentSignature> {\n    const signPayload = this.paymentSignPayloadEncoder.encode(payment);\n    const contractSigningPromise = this.inMemorySigner.sign(signPayload.contractSignPayload);\n    const signingPromises = signPayload.clientSignPayload\n      ? [contractSigningPromise, this.inMemorySigner.sign(signPayload.clientSignPayload)]\n      : [contractSigningPromise];\n\n    // TODO: add \"[Awaited<ReturnType<typeof this.inMemorySigner.sign>>, Awaited<ReturnType<typeof this.inMemorySigner.sign>>?]\" type\n    const signatures = await Promise.all(signingPromises);\n\n    return {\n      signingPublicKey: await this.inMemorySigner.publicKey(),\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      contract: signatures[0]!.prefixSig,\n      client: signatures[1]?.prefixSig,\n    };\n  }\n}\n","import { UnsignedPayment, PaymentSignature, PaymentSignPayloadEncoder } from '@tezospayments/common';\n\nimport { SigningType } from '../models';\nimport { TezosPaymentsSigner } from './tezosPaymentsSigner';\n\nexport class WalletSigner extends TezosPaymentsSigner {\n  protected readonly paymentSignPayloadEncoder: PaymentSignPayloadEncoder = new PaymentSignPayloadEncoder();\n\n  constructor(readonly walletSigning: (dataBytes: string) => Promise<string>) {\n    super(SigningType.Wallet);\n  }\n\n  async sign(payment: UnsignedPayment): Promise<PaymentSignature> {\n    const signPayload = this.paymentSignPayloadEncoder.encode(payment);\n    const walletContractSignPayload = signPayload.contractSignPayload.substring(2);\n\n    const contractSigningPromise = this.walletSigning(walletContractSignPayload);\n    const signingPromises = signPayload.clientSignPayload\n      ? [contractSigningPromise, this.walletSigning(signPayload.clientSignPayload)]\n      : [contractSigningPromise];\n\n    // TODO: add \"[Awaited<ReturnType<typeof this.inMemorySigner.sign>>, Awaited<ReturnType<typeof this.inMemorySigner.sign>>?]\" type\n    const signatures = await Promise.all(signingPromises);\n\n    return {\n      signingPublicKey: '',\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      contract: signatures[0]!,\n      client: signatures[1],\n    };\n  }\n}\n","import type { UnsignedPayment, PaymentSignature } from '@tezospayments/common';\n\nimport { SigningType } from '../models';\nimport { TezosPaymentsSigner } from './tezosPaymentsSigner';\n\nexport class CustomSigner extends TezosPaymentsSigner {\n  constructor(readonly customSigning: (payment: UnsignedPayment) => Promise<string>) {\n    super(SigningType.Custom);\n  }\n\n  sign(_payment: UnsignedPayment): PaymentSignature | Promise<PaymentSignature> {\n    throw new Error('Method not implemented.');\n  }\n}\n","export const tezosPaymentsOptionsValidationErrors = {\n  // serviceContractAddress\n  invalidServiceContractAddressType: 'Type of the serviceContractAddress option is invalid',\n  serviceContractAddressHasInvalidLength: 'The serviceContractAddress option has an invalid address',\n  serviceContractAddressIsNotContractAddress: 'The serviceContractAddress option isn\\'t a contract address',\n  // signing\n  invalidSigningOption: 'The signing option is invalid',\n  invalidApiSecretKeyType: 'The API secret key has an invalid type, it should be a string',\n  emptyApiSecretKey: 'The API secret key is empty',\n  invalidWalletSigningOptionType: 'The WalletSigning option has an invalid type, it should be a function',\n  // defaultPaymentParameters\n  invalidDefaultPaymentParameters: 'The default payment parameters are invalid',\n  // defaultPaymentParameters.network\n  emptyNetworkName: 'The network name is empty',\n  invalidNetwork: 'The network is invalid',\n  invalidNetworkName: 'The network name is invalid',\n  invalidNetworkId: 'The network id is invalid',\n  // defaultPaymentParameters.urlType\n  invalidUrlType: 'The url type is invalid'\n} as const;\n","import BigNumber from 'bignumber.js';\nimport { nanoid } from 'nanoid';\n\nimport {\n  native, networks, tezosInfo, networkNameRegExp, networkIdRegExp, PaymentUrlType,\n  DeepReadonly, FailedValidationResults, UnsignedPayment as CommonUnsignedPaymentModel, Payment as CommonPaymentModel,\n  PaymentType, PaymentValidator, Mutable\n} from '@tezospayments/common';\n\nimport { InvalidPaymentCreateParametersError, InvalidPaymentError, InvalidTezosPaymentsOptionsError, UnsupportedPaymentUrlTypeError } from './errors';\nimport { Payment } from './models';\nimport type { DefaultPaymentParameters, PaymentCreateParameters, TezosPaymentsOptions } from './options';\nimport { Base64PaymentUrlFactory, PaymentUrlFactory } from './paymentUrlFactories';\nimport { ApiSecretKeySigner, CustomSigner, TezosPaymentsSigner, WalletSigner } from './signers';\nimport { tezosPaymentsOptionsValidationErrors } from './validationErrors';\n\nexport class TezosPayments {\n  static readonly defaultPaymentParameters: DeepReadonly<DefaultPaymentParameters> = {\n    network: networks.granadanet,\n    urlType: PaymentUrlType.Base64\n  };\n  protected static readonly optionsValidationErrors = tezosPaymentsOptionsValidationErrors;\n\n  protected readonly paymentValidator: PaymentValidator = new PaymentValidator();\n  protected readonly serviceContractAddress: string;\n  protected readonly signer: TezosPaymentsSigner;\n  protected readonly defaultPaymentParameters: DeepReadonly<DefaultPaymentParameters>;\n\n  private paymentUrlFactories: Map<PaymentUrlType, PaymentUrlFactory> = new Map();\n\n  constructor(options: DeepReadonly<TezosPaymentsOptions>) {\n    const errors = this.validateOptions(options);\n    if (errors)\n      throw new InvalidTezosPaymentsOptionsError(errors);\n\n    this.serviceContractAddress = options.serviceContractAddress;\n    this.defaultPaymentParameters = options.defaultPaymentParameters\n      ? {\n        network: options.defaultPaymentParameters.network || TezosPayments.defaultPaymentParameters.network,\n        urlType: options.defaultPaymentParameters.urlType || TezosPayments.defaultPaymentParameters.urlType\n      }\n      : TezosPayments.defaultPaymentParameters;\n\n    this.signer = this.createSigner(options.signing);\n    this.getPaymentUrlFactory(this.defaultPaymentParameters.urlType);\n  }\n\n  async createPayment(createParameters: PaymentCreateParameters): Promise<Payment> {\n    if (!createParameters)\n      throw new InvalidPaymentCreateParametersError(createParameters);\n\n    let errors: FailedValidationResults;\n    if (createParameters.urlType) {\n      errors = this.validateDefaultPaymentParameters(createParameters);\n      if (errors)\n        throw new InvalidPaymentError(errors);\n    }\n\n    const unsignedPayment = this.createPaymentByCreateParameters(createParameters);\n    errors = this.paymentValidator.validate(unsignedPayment, true);\n    if (errors)\n      throw new InvalidPaymentError(errors);\n\n    const signedPayment = await this.getSignedPayment(unsignedPayment);\n    errors = this.paymentValidator.validate(signedPayment, true);\n    if (errors)\n      throw new InvalidPaymentError(errors);\n\n    const paymentUrl = await this.getPaymentUrl(signedPayment, createParameters.urlType);\n    const payment = this.applyPaymentUrl(signedPayment, paymentUrl);\n\n    return payment;\n  }\n\n  protected getPaymentUrl(payment: CommonPaymentModel, urlType = this.defaultPaymentParameters.urlType): string | Promise<string> {\n    return this.getPaymentUrlFactory(urlType).createPaymentUrl(payment, this.defaultPaymentParameters.network);\n  }\n\n  protected applyPaymentUrl(payment: CommonPaymentModel, url: string): Payment {\n    (payment as Mutable<Payment>).url = url;\n\n    return (payment as Payment);\n  }\n\n  protected getPaymentUrlFactory(paymentUrlType: PaymentUrlType): PaymentUrlFactory {\n    let paymentUrlFactory = this.paymentUrlFactories.get(paymentUrlType);\n    if (!paymentUrlFactory) {\n      paymentUrlFactory = this.createPaymentUrlFactory(paymentUrlType);\n      this.paymentUrlFactories.set(paymentUrlType, paymentUrlFactory);\n    }\n\n    return paymentUrlFactory;\n  }\n\n  protected async getSignedPayment(unsignedPayment: CommonUnsignedPaymentModel): Promise<CommonPaymentModel> {\n    (unsignedPayment as Mutable<CommonPaymentModel>).signature = await this.signer.sign(unsignedPayment);\n\n    return unsignedPayment as CommonPaymentModel;\n  }\n\n  protected createSigner(signingOptions: TezosPaymentsOptions['signing']): TezosPaymentsSigner {\n    if ('apiSecretKey' in signingOptions)\n      return new ApiSecretKeySigner(signingOptions.apiSecretKey);\n    if ('walletSigning' in signingOptions)\n      return new WalletSigner(signingOptions.walletSigning);\n\n    return new CustomSigner(signingOptions);\n  }\n\n  protected createPaymentUrlFactory(paymentUrlType: PaymentUrlType): PaymentUrlFactory {\n    switch (paymentUrlType) {\n      case PaymentUrlType.Base64:\n        return new Base64PaymentUrlFactory();\n      default:\n        throw new UnsupportedPaymentUrlTypeError(`This payment url type is not supported: ${paymentUrlType}`);\n    }\n  }\n\n  protected createPaymentByCreateParameters(createParameters: PaymentCreateParameters): CommonUnsignedPaymentModel {\n    // TODO: check decimals\n    // TODO: floor amount to decimals count: new BigNumber(amount).toFixed(asset.decimals)\n    const payment: Mutable<CommonUnsignedPaymentModel> = {\n      type: PaymentType.Payment,\n      id: createParameters.id || nanoid(),\n      targetAddress: this.serviceContractAddress,\n      amount: new BigNumber(createParameters.amount),\n      data: createParameters.data,\n      created: createParameters.created ? new Date(createParameters.created) : new Date(),\n    };\n\n    if (createParameters.asset)\n      payment.asset = createParameters.asset;\n    if (createParameters.expired)\n      payment.expired = new Date(createParameters.expired);\n    if (createParameters.successUrl)\n      payment.successUrl = new native.URL(createParameters.successUrl);\n    if (createParameters.cancelUrl)\n      payment.cancelUrl = new native.URL(createParameters.cancelUrl);\n\n    return payment;\n  }\n\n  protected validateOptions(options: DeepReadonly<TezosPaymentsOptions>): FailedValidationResults {\n    return [\n      this.validateServiceContractAddress(options.serviceContractAddress),\n      this.validateSigningOptions(options.signing),\n      this.validateDefaultPaymentParameters(options.defaultPaymentParameters)\n    ].reduce(\n      (result, currentErrors) => currentErrors ? (result || []).concat(currentErrors) : result,\n      undefined\n    );\n  }\n\n  private validateServiceContractAddress(serviceContractAddress: string): FailedValidationResults {\n    if (!serviceContractAddress || typeof serviceContractAddress !== 'string')\n      return [TezosPayments.optionsValidationErrors.invalidServiceContractAddressType];\n\n    if (serviceContractAddress.length !== tezosInfo.addressLength)\n      return [TezosPayments.optionsValidationErrors.serviceContractAddressHasInvalidLength];\n\n    if (!tezosInfo.contractAddressPrefixes.some(prefix => serviceContractAddress.startsWith(prefix)))\n      return [TezosPayments.optionsValidationErrors.serviceContractAddressIsNotContractAddress];\n  }\n\n  private validateSigningOptions(signingOptions: TezosPaymentsOptions['signing']): FailedValidationResults {\n    if (typeof signingOptions !== 'object')\n      return [TezosPayments.optionsValidationErrors.invalidSigningOption];\n\n    if (typeof signingOptions === 'function')\n      return;\n    else if (!('apiSecretKey' in signingOptions) && !('walletSigning' in signingOptions))\n      return [TezosPayments.optionsValidationErrors.invalidSigningOption];\n\n    if ('apiSecretKey' in signingOptions) {\n      if (typeof signingOptions.apiSecretKey !== 'string')\n        return [TezosPayments.optionsValidationErrors.invalidApiSecretKeyType];\n      if (!signingOptions.apiSecretKey)\n        return [TezosPayments.optionsValidationErrors.emptyApiSecretKey];\n    }\n\n    if ('walletSigning' in signingOptions && typeof signingOptions.walletSigning !== 'function')\n      return [TezosPayments.optionsValidationErrors.invalidWalletSigningOptionType];\n  }\n\n  private validateDefaultPaymentParameters(defaultPaymentParameters: TezosPaymentsOptions['defaultPaymentParameters']): FailedValidationResults {\n    if (defaultPaymentParameters === undefined)\n      return;\n\n    if (typeof defaultPaymentParameters !== 'object')\n      return [TezosPayments.optionsValidationErrors.invalidDefaultPaymentParameters];\n\n    if ('network' in defaultPaymentParameters) {\n      if (typeof defaultPaymentParameters.network !== 'object')\n        return [TezosPayments.optionsValidationErrors.invalidNetwork];\n\n      if (defaultPaymentParameters.network.name === undefined || defaultPaymentParameters.network.name === '')\n        return [TezosPayments.optionsValidationErrors.emptyNetworkName];\n\n      if (typeof defaultPaymentParameters.network.name !== 'string' || !networkNameRegExp.test(defaultPaymentParameters.network.name))\n        return [TezosPayments.optionsValidationErrors.invalidNetworkName];\n\n      if (defaultPaymentParameters.network.id && (typeof defaultPaymentParameters.network.id !== 'string' || !networkIdRegExp.test(defaultPaymentParameters.network.id)))\n        return [TezosPayments.optionsValidationErrors.invalidNetworkId];\n    }\n\n    if ('urlType' in defaultPaymentParameters && defaultPaymentParameters.urlType !== PaymentUrlType.Base64)\n      return [TezosPayments.optionsValidationErrors.invalidUrlType];\n  }\n}\n","import constants from './constants';\nimport * as errors from './errors';\nimport * as paymentUrlFactories from './paymentUrlFactories';\nimport * as signers from './signers';\n\nexport { PaymentUrlType } from '@tezospayments/common';\nexport type { PaymentAsset } from '@tezospayments/common';\n\nexport type { Payment } from './models';\nexport { SigningType } from './models';\n\nexport type { TezosPaymentsOptions, PaymentCreateParameters } from './options';\nexport { TezosPayments } from './tezosPayments';\n\nexport const internal = {\n  constants,\n  errors,\n  paymentUrlFactories,\n  signers\n};\n"],"names":["defaultNetworkName","paymentAppBaseUrl","getErrorMessageByValidationErrors","validationErrors","brief","reduce","result","error","index","TezosPaymentsError","message","name","constructor","Error","InvalidTezosPaymentsOptionsError","messageOrValidationErrors","guards","isReadonlyArray","getMessage","InvalidPaymentCreateParametersError","InvalidPaymentError","UnsupportedPaymentUrlTypeError","PaymentUrlError","DonationUrlError","PaymentUrlFactory","urlType","Base64PaymentUrlFactory","baseUrl","PaymentUrlType","Base64","PaymentSerializer","DonationSerializer","paymentOrDonation","network","type","PaymentType","Payment","createPaymentUrlInternal","createDonationUrlInternal","payment","serializedPaymentBase64","paymentSerializer","serialize","createUrl","targetAddress","donation","serializedDonationBase64","donationSerializer","isPayment","serializedPaymentOrDonationBase64","url","native","URL","hash","getEncodedPaymentUrlType","constants","searchParams","append","href","TezosPaymentsSigner","signingType","SigningType","ApiSecretKeySigner","apiSecretKey","ApiSecretKey","PaymentSignPayloadEncoder","inMemorySigner","InMemorySigner","signPayload","paymentSignPayloadEncoder","encode","contractSigningPromise","sign","contractSignPayload","signingPromises","clientSignPayload","Promise","all","signatures","publicKey","prefixSig","signingPublicKey","contract","client","WalletSigner","walletSigning","Wallet","walletContractSignPayload","substring","CustomSigner","customSigning","Custom","_payment","tezosPaymentsOptionsValidationErrors","invalidServiceContractAddressType","serviceContractAddressHasInvalidLength","serviceContractAddressIsNotContractAddress","invalidSigningOption","invalidApiSecretKeyType","emptyApiSecretKey","invalidWalletSigningOptionType","invalidDefaultPaymentParameters","emptyNetworkName","invalidNetwork","invalidNetworkName","invalidNetworkId","invalidUrlType","TezosPayments","options","PaymentValidator","Map","errors","validateOptions","serviceContractAddress","defaultPaymentParameters","signer","createSigner","signing","getPaymentUrlFactory","createParameters","validateDefaultPaymentParameters","unsignedPayment","createPaymentByCreateParameters","paymentValidator","validate","getSignedPayment","signedPayment","getPaymentUrl","paymentUrl","applyPaymentUrl","createPaymentUrl","paymentUrlType","paymentUrlFactory","paymentUrlFactories","get","createPaymentUrlFactory","set","signature","signingOptions","id","nanoid","amount","BigNumber","data","created","Date","asset","expired","successUrl","cancelUrl","validateServiceContractAddress","validateSigningOptions","currentErrors","concat","undefined","optionsValidationErrors","length","tezosInfo","addressLength","contractAddressPrefixes","some","prefix","startsWith","networkNameRegExp","test","networkIdRegExp","networks","granadanet","internal","signers"],"mappings":"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"}